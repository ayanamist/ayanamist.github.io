---
layout: post
title: 豆瓣电台Android版蓝牙连接修复版
date: '2012-11-30T00:38:00+08:00'
tags:
- android
- 技术
tumblr_url: http://blog.ayanamist.com/post/36814192368
---
<a href="https://github.com/ayanamist/doubanfm-android-smali/downloads">豆瓣电台Android版蓝牙连接修复版</a><br/><p>Android 2.X系列，对于蓝牙耳机的支持有个bug，就是进入深度睡眠时，会断开蓝牙耳机的连接。于是用蓝牙耳机听歌的时候，就会很苦逼的听几秒钟，屏幕一黑，然后就没声音了。<br/>当然，据说这个bug已经在4.X里解决了，我没相关设备，也就不知道了。</p>
<p>当然，已经有人出了<a href="https://play.google.com/store/apps/details?id=org.floodping.BluetoothKeepalive" target="_blank">一个略显傻瓜的App</a>来修复这个问题，唯独其中不美的地方是居然这软件收费。当然，最终我还是费尽周折买了这个App。</p>
<p>但这个App并不是很稳定，有时候蓝牙连上了，它的后台服务也跑着，却没有作用，非得重新启动一下这个App才行</p>
<p>想着反正我也只是听着豆瓣电台，索性给豆瓣电台的App打个补丁好了。</p>
<p>反编译那个收费App，发现用的是<a href="http://developer.android.com/reference/android/os/PowerManager.html" target="_blank">PowerManager的相关API</a>。于是把相关的smali码尽数移植到豆瓣电台的smali码里，其中种种周折略过不提。</p>
<p>目前豆瓣电台官网上显示的版本号是2.1.3，但下载下来的App里安装后显示的却是2.1.4，所以我还是以2.1.4做版本号</p>
<p>整个smali码的修改都放在这个链接的项目里了。apktool工具的使用不赘述。<br/>小白可以无视并直接猛击链接里的apk文件下载即可。</p>
<p>切记要先卸载官方版本，否则签名不对，是不能覆盖安装的</p>
